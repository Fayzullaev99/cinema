"use strict";

// Top nav 
var navToggleElements = document.querySelectorAll('.top-nav__btn, .top-nav__list'),
    navControlElements = document.querySelectorAll('.top-nav__btn, .top-nav__close');
navControlElements.forEach(function (btn) {
  return btn.addEventListener('click', function () {
    return navToggleElements.forEach(function (el) {
      return el.classList.toggle('open');
    });
  });
}); // One-film Video
// linear-gradient(90deg, #DEF7FF 0%, #F4FCFF 45.64%, rgba(255, 255, 255, 0) 100.72%)

var fillBg = function fillBg(animationTime) {
  var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
  var time = animationTime / 100;

  if (i <= 100) {
    oneFilm.style.background = "linear-gradient(90deg, #DEF7FF ".concat(i, "%, #F4FCFF 45.64%, rgba(255, 255, 255, 0) 100.72%)");
    setTimeout(function () {
      return fillBg(animationTime, i + 1);
    }, time);
  }
};

var clearBg = function clearBg(animationTime) {
  var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;
  var time = animationTime / 100;

  if (i >= 0) {
    oneFilm.style.background = "linear-gradient(90deg, #DEF7FF ".concat(i, "%, #F4FCFF 45.64%, rgba(255, 255, 255, 0) 100.72%)");
    setTimeout(function () {
      return clearBg(animationTime, i - 1);
    }, time);
  }
};

var film = document.querySelector('.one-film__bg'),
    filmBlock = document.querySelector('.one-film__video-block'),
    oneFilm = document.querySelector('.one-film'),
    filmClose = document.querySelector('.one-film__close'),
    play = document.getElementById('play'),
    playPause = document.querySelector('.controls__play'),
    current = document.getElementById('current'),
    controls = document.querySelector('.controls'),
    duration = document.getElementById('duration'),
    speedUp = document.querySelector('.controls__speed-up'),
    speedDown = document.querySelector('.controls__speed-down'),
    speed = document.querySelector('.controls__speed'),
    stop = document.querySelector('.controls__stop'),
    volumeProgress = document.querySelector('.controls__volume-progress'),
    volumeIcon = document.querySelector('.controls__volume-icon'),
    volumeRuler = document.querySelector('.controls__volume-ruler'),
    volumeLine = document.querySelector('.controls__volume-line');

play.onclick = function (e) {
  duration.innerHTML = translateTime(film.duration);
  e.preventDefault();
  filmBlock.style.opacity = 0;
  document.body.style.overflowY = 'hidden';
  setTimeout(function () {
    return filmBlock.classList.add('active');
  }, 500);
  setTimeout(function () {
    return filmBlock.style.opacity = '1';
  }, 1000);
  fillBg(500);
};

filmClose.onclick = function () {
  if (!film.paused) {
    film.pause();
    clearInterval(currentTimeInterval);
  }

  filmBlock.style.opacity = 0;
  document.body.style.overflowY = 'scroll';
  setTimeout(function () {
    return filmBlock.classList.remove('active');
  }, 500);
  setTimeout(function () {
    return filmBlock.style.opacity = '1';
  }, 1000);
  clearBg();
}; // Video play and pause


var currentTimeInterval;

playPause.onclick = function (e) {
  e.target.classList.toggle('paused');

  if (film.paused) {
    film.play();
    currentTimeInterval = setInterval(function () {
      current.innerHTML = translateTime(film.currentTime);
    }, 1000);
  } else {
    film.pause();
    clearInterval(currentTimeInterval);
  }
}; // Translate seconds to time


function translateTime(time) {
  var addZero = function addZero(num) {
    return num < 10 ? '0' + num : num;
  };

  var hour = Math.trunc(time / 3600);
  time -= hour * 3600;
  var minute = Math.trunc(time / 60);
  time -= minute * 60;
  time = Math.trunc(time);
  return "".concat(hour, ":").concat(addZero(minute), ":").concat(addZero(time));
} // Film speed change


speedUp.onclick = function (e) {
  return speedChange(e.target);
};

speedDown.onclick = function (e) {
  return speedChange(e.target);
};

function speedChange(btn) {
  if (speedUp === btn && film.playbackRate < 3) {
    film.playbackRate += 0.25;
  } else if (speedDown === btn && film.playbackRate > 0) {
    film.playbackRate -= 0.25;
  }

  writeSpeed();
} // Film restart


stop.onclick = function (e) {
  if (!film.paused) {
    film.pause();
    clearInterval(currentTimeInterval);
    playPause.classList.remove('paused');
  }

  film.currentTime = 0;
  current.innerHTML = translateTime(film.currentTime);
  film.playbackRate = 1;
  writeSpeed();
}; // Write film speed


function writeSpeed() {
  speed.innerHTML = film.playbackRate + 'x';
} // On film end


film.onended = function () {
  film.pause();
  clearInterval(currentTimeInterval);
  playPause.classList.remove('paused');
  film.currentTime = 0;
  current.innerHTML = translateTime(film.currentTime);
}; // Volume change


var volumeClasses = ['up', 'slash', 'down', 'normal', 'off', 'mute'];

film.onvolumechange = function () {
  volumeProgress.style.width = film.volume * 100 + '%';
  var volume = film.volume * 100;
  volumeClasses.forEach(function (className) {
    return volumeIcon.classList.remove(className);
  });

  if (film.muted) {
    volumeIcon.classList.add('slash');
  } else if (volume > 75) {
    volumeIcon.classList.add('up');
  } else if (volume > 50) {
    volumeIcon.classList.add('normal');
  } else if (volume > 25) {
    volumeIcon.classList.add('down');
  } else if (volume > 0) {
    volumeIcon.classList.add('off');
  } else if (volume === 0) {
    volumeIcon.classList.add('mute');
  }
}; // Volume Icon click


volumeIcon.onclick = function () {
  return film.muted = !film.muted;
}; // Volume line click 


volumeLine.onclick = function (e) {
  if (e.target !== volumeRuler) {
    film.volume = e.offsetX / 100;
  }
}; // Volume Rule


volumeRuler.onmousedown = function () {
  window.onmousemove = volumeMove;
};

window.onmouseup = function () {
  window.onmousemove = null;
};

function volumeMove(e) {
  if (e.clientX >= volumeLine.offsetLeft && e.clientX <= volumeLine.offsetLeft + volumeLine.clientWidth) {
    film.volume = (e.clientX - volumeLine.offsetLeft) / 100;
  }
} // MouseWheel volume control


filmBlock.onwheel = function (e) {
  var volume = Math.trunc(film.volume * 100);

  if (e.deltaY < 0 && volume < 96) {
    volume += 5;
  } else if (e.deltaY > 0 && volume > 4) {
    volume -= 5;
  }

  film.volume = volume / 100;
}; // Controls panel show


var controlsShow = function controlsShow() {
  if (window.innerHeight < window.innerWidth) {
    if (controls.classList.contains('show')) {
      controls.classList.remove('show');
    }
  }
};

var controlsInterval = setInterval(controlsShow, 3000);

film.ontouchstart = function () {
  clearInterval(controlsInterval);
  controlsInterval = setInterval(controlsShow, 3000);

  if (!controls.classList.contains('show')) {
    controls.classList.add('show');
  }
}; // window.addEventListener('scroll', ()=>{
//   if (oneFilm.offsetTop < pageYOffset + innerHeight) {
//     console.dir(film)
//     film.play()
//   }
// })
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJuYXZUb2dnbGVFbGVtZW50cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIm5hdkNvbnRyb2xFbGVtZW50cyIsImZvckVhY2giLCJidG4iLCJhZGRFdmVudExpc3RlbmVyIiwiZWwiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJmaWxsQmciLCJhbmltYXRpb25UaW1lIiwiaSIsInRpbWUiLCJvbmVGaWxtIiwic3R5bGUiLCJiYWNrZ3JvdW5kIiwic2V0VGltZW91dCIsImNsZWFyQmciLCJmaWxtIiwicXVlcnlTZWxlY3RvciIsImZpbG1CbG9jayIsImZpbG1DbG9zZSIsInBsYXkiLCJnZXRFbGVtZW50QnlJZCIsInBsYXlQYXVzZSIsImN1cnJlbnQiLCJjb250cm9scyIsImR1cmF0aW9uIiwic3BlZWRVcCIsInNwZWVkRG93biIsInNwZWVkIiwic3RvcCIsInZvbHVtZVByb2dyZXNzIiwidm9sdW1lSWNvbiIsInZvbHVtZVJ1bGVyIiwidm9sdW1lTGluZSIsIm9uY2xpY2siLCJlIiwiaW5uZXJIVE1MIiwidHJhbnNsYXRlVGltZSIsInByZXZlbnREZWZhdWx0Iiwib3BhY2l0eSIsImJvZHkiLCJvdmVyZmxvd1kiLCJhZGQiLCJwYXVzZWQiLCJwYXVzZSIsImNsZWFySW50ZXJ2YWwiLCJjdXJyZW50VGltZUludGVydmFsIiwicmVtb3ZlIiwidGFyZ2V0Iiwic2V0SW50ZXJ2YWwiLCJjdXJyZW50VGltZSIsImFkZFplcm8iLCJudW0iLCJob3VyIiwiTWF0aCIsInRydW5jIiwibWludXRlIiwic3BlZWRDaGFuZ2UiLCJwbGF5YmFja1JhdGUiLCJ3cml0ZVNwZWVkIiwib25lbmRlZCIsInZvbHVtZUNsYXNzZXMiLCJvbnZvbHVtZWNoYW5nZSIsIndpZHRoIiwidm9sdW1lIiwiY2xhc3NOYW1lIiwibXV0ZWQiLCJvZmZzZXRYIiwib25tb3VzZWRvd24iLCJ3aW5kb3ciLCJvbm1vdXNlbW92ZSIsInZvbHVtZU1vdmUiLCJvbm1vdXNldXAiLCJjbGllbnRYIiwib2Zmc2V0TGVmdCIsImNsaWVudFdpZHRoIiwib253aGVlbCIsImRlbHRhWSIsImNvbnRyb2xzU2hvdyIsImlubmVySGVpZ2h0IiwiaW5uZXJXaWR0aCIsImNvbnRhaW5zIiwiY29udHJvbHNJbnRlcnZhbCIsIm9udG91Y2hzdGFydCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBLElBQU1BLGlCQUFpQixHQUFHQyxRQUFRLENBQUNDLGdCQUFULENBQTBCLCtCQUExQixDQUExQjtBQUFBLElBQ0VDLGtCQUFrQixHQUFHRixRQUFRLENBQUNDLGdCQUFULENBQTBCLGdDQUExQixDQUR2QjtBQUdBQyxrQkFBa0IsQ0FBQ0MsT0FBbkIsQ0FBMkIsVUFBQUMsR0FBRztBQUFBLFNBQUlBLEdBQUcsQ0FBQ0MsZ0JBQUosQ0FBcUIsT0FBckIsRUFBOEI7QUFBQSxXQUM5RE4saUJBQWlCLENBQUNJLE9BQWxCLENBQTBCLFVBQUFHLEVBQUU7QUFBQSxhQUFJQSxFQUFFLENBQUNDLFNBQUgsQ0FBYUMsTUFBYixDQUFvQixNQUFwQixDQUFKO0FBQUEsS0FBNUIsQ0FEOEQ7QUFBQSxHQUE5QixDQUFKO0FBQUEsQ0FBOUIsRSxDQUlBO0FBQ0E7O0FBQ0EsSUFBTUMsTUFBTSxHQUFHLFNBQVRBLE1BQVMsQ0FBQ0MsYUFBRCxFQUEwQjtBQUFBLE1BQVZDLENBQVUsdUVBQU4sQ0FBTTtBQUN2QyxNQUFJQyxJQUFJLEdBQUdGLGFBQWEsR0FBRyxHQUEzQjs7QUFDQSxNQUFJQyxDQUFDLElBQUksR0FBVCxFQUFjO0FBQ1pFLElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjQyxVQUFkLDRDQUE2REosQ0FBN0Q7QUFDQUssSUFBQUEsVUFBVSxDQUFDO0FBQUEsYUFBTVAsTUFBTSxDQUFDQyxhQUFELEVBQWdCQyxDQUFDLEdBQUcsQ0FBcEIsQ0FBWjtBQUFBLEtBQUQsRUFBcUNDLElBQXJDLENBQVY7QUFDRDtBQUNGLENBTkQ7O0FBUUEsSUFBTUssT0FBTyxHQUFHLFNBQVZBLE9BQVUsQ0FB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QixDQUE0QixNQUE1QixDQUFMLEVBQTBDO0FBQ3hDekQsSUFBQUEsUUFBUSxDQUFDbkIsU0FBVCxDQUFtQnFDLEdBQW5CLENBQXVCLE1BQXZCO0FBQ0Q7QUFDRixDQU5ELEMsQ0FTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUb3AgbmF2IFxyXG5jb25zdCBuYXZUb2dnbGVFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b3AtbmF2X19idG4sIC50b3AtbmF2X19saXN0JyksXHJcbiAgbmF2Q29udHJvbEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvcC1uYXZfX2J0biwgLnRvcC1uYXZfX2Nsb3NlJyk7XHJcblxyXG5uYXZDb250cm9sRWxlbWVudHMuZm9yRWFjaChidG4gPT4gYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT5cclxuICBuYXZUb2dnbGVFbGVtZW50cy5mb3JFYWNoKGVsID0+IGVsLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKSlcclxuKSlcclxuXHJcbi8vIE9uZS1maWxtIFZpZGVvXHJcbi8vIGxpbmVhci1ncmFkaWVudCg5MGRlZywgI0RFRjdGRiAwJSwgI0Y0RkNGRiA0NS42NCUsIHJnYmEoMjU1LCAyNTUsIDI1NSwgMCkgMTAwLjcyJSlcclxuY29uc3QgZmlsbEJnID0gKGFuaW1hdGlvblRpbWUsIGkgPSAwKSA9PiB7XHJcbiAgbGV0IHRpbWUgPSBhbmltYXRpb25UaW1lIC8gMTAwXHJcbiAgaWYgKGkgPD0gMTAwKSB7XHJcbiAgICBvbmVGaWxtLnN0eWxlLmJhY2tncm91bmQgPSBgbGluZWFyLWdyYWRpZW50KDkwZGVnLCAjREVGN0ZGICR7aX0lLCAjRjRGQ0ZGIDQ1LjY0JSwgcmdiYSgyNTUsIDI1NSwgMjU1LCAwKSAxMDAuNzIlKWBcclxuICAgIHNldFRpbWVvdXQoKCkgPT4gZmlsbEJnKGFuaW1hdGlvblRpbWUsIGkgKyAxKSwgdGltZSlcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IGNsZWFyQmcgPSAoYW5pbWF0aW9uVGltZSwgaSA9IDEwMCkgPT4ge1xyXG4gIGxldCB0aW1lID0gYW5pbWF0aW9uVGltZSAvIDEwMFxyXG4gIGlmIChpID49IDApIHtcclxuICAgIG9uZUZpbG0uc3R5bGUuYmFja2dyb3VuZCA9IGBsaW5lYXItZ3JhZGllbnQoOTBkZWcsICNERUY3RkYgJHtpfSUsICNGNEZDRkYgNDUuNjQlLCByZ2JhKDI1NSwgMjU1LCAyNTUsIDApIDEwMC43MiUpYFxyXG4gICAgc2V0VGltZW91dCgoKSA9PiBjbGVhckJnKGFuaW1hdGlvblRpbWUsIGkgLSAxKSwgdGltZSlcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IGZpbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub25lLWZpbG1fX2JnJyksXHJcbiAgZmlsbUJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm9uZS1maWxtX192aWRlby1ibG9jaycpLFxyXG4gIG9uZUZpbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub25lLWZpbG0nKSxcclxuICBmaWxtQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub25lLWZpbG1fX2Nsb3NlJyksXHJcbiAgcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5JyksXHJcbiAgcGxheVBhdXNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19wbGF5JyksXHJcbiAgY3VycmVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50JyksXHJcbiAgY29udHJvbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHMnKSxcclxuICBkdXJhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkdXJhdGlvbicpLFxyXG4gIHNwZWVkVXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX3NwZWVkLXVwJyksXHJcbiAgc3BlZWREb3duID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX19zcGVlZC1kb3duJyksXHJcbiAgc3BlZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX3NwZWVkJyksXHJcbiAgc3RvcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9sc19fc3RvcCcpLFxyXG4gIHZvbHVtZVByb2dyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX192b2x1bWUtcHJvZ3Jlc3MnKSxcclxuICB2b2x1bWVJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX192b2x1bWUtaWNvbicpLFxyXG4gIHZvbHVtZVJ1bGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX192b2x1bWUtcnVsZXInKSxcclxuICB2b2x1bWVMaW5lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyb2xzX192b2x1bWUtbGluZScpXHJcblxyXG5cclxucGxheS5vbmNsaWNrID0gZSA9PiB7XHJcbiAgZHVyYXRpb24uaW5uZXJIVE1MID0gdHJhbnNsYXRlVGltZShmaWxtLmR1cmF0aW9uKVxyXG4gIGUucHJldmVudERlZmF1bHQoKVxyXG4gIGZpbG1CbG9jay5zdHlsZS5vcGFjaXR5ID0gMFxyXG4gIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3dZID0gJ2hpZGRlbidcclxuICBzZXRUaW1lb3V0KCgpID0+IGZpbG1CbG9jay5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKSwgNTAwKVxyXG4gIHNldFRpbWVvdXQoKCkgPT4gZmlsbUJsb2NrLnN0eWxlLm9wYWNpdHkgPSAnMScsIDEwMDApXHJcbiAgZmlsbEJnKDUwMClcclxufVxyXG5cclxuZmlsbUNsb3NlLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgaWYgKCFmaWxtLnBhdXNlZCkge1xyXG4gICAgZmlsbS5wYXVzZSgpXHJcbiAgICBjbGVhckludGVydmFsKGN1cnJlbnRUaW1lSW50ZXJ2YWwpXHJcbiAgfVxyXG4gIGZpbG1CbG9jay5zdHlsZS5vcGFjaXR5ID0gMFxyXG4gIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3dZID0gJ3Njcm9sbCdcclxuICBzZXRUaW1lb3V0KCgpID0+IGZpbG1CbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSwgNTAwKVxyXG4gIHNldFRpbWVvdXQoKCkgPT4gZmlsbUJsb2NrLnN0eWxlLm9wYWNpdHkgPSAnMScsIDEwMDApXHJcbiAgY2xlYXJCZygpXHJcbn1cclxuXHJcbi8vIFZpZGVvIHBsYXkgYW5kIHBhdXNlXHJcbmxldCBjdXJyZW50VGltZUludGVydmFsXHJcbnBsYXlQYXVzZS5vbmNsaWNrID0gZSA9PiB7XHJcbiAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgncGF1c2VkJylcclxuICBpZiAoZmlsbS5wYXVzZWQpIHtcclxuICAgIGZpbG0ucGxheSgpXHJcbiAgICBjdXJyZW50VGltZUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICBjdXJyZW50LmlubmVySFRNTCA9IHRyYW5zbGF0ZVRpbWUoZmlsbS5jdXJyZW50VGltZSlcclxuICAgIH0sIDEwMDApXHJcbiAgfSBlbHNlIHtcclxuICAgIGZpbG0ucGF1c2UoKVxyXG4gICAgY2xlYXJJbnRlcnZhbChjdXJyZW50VGltZUludGVydmFsKVxyXG4gIH1cclxufVxyXG5cclxuLy8gVHJhbnNsYXRlIHNlY29uZHMgdG8gdGltZVxyXG5mdW5jdGlvbiB0cmFuc2xhdGVUaW1lKHRpbWUpIHtcclxuICBjb25zdCBhZGRaZXJvID0gbnVtID0+IG51bSA8IDEwID8gJzAnICsgbnVtIDogbnVtXHJcbiAgbGV0IGhvdXIgPSBNYXRoLnRydW5jKHRpbWUgLyAzNjAwKVxyXG4gIHRpbWUgLT0gaG91ciAqIDM2MDBcclxuICBsZXQgbWludXRlID0gTWF0aC50cnVuYyh0aW1lIC8gNjApXHJcbiAgdGltZSAtPSBtaW51dGUgKiA2MFxyXG4gIHRpbWUgPSBNYXRoLnRydW5jKHRpbWUpXHJcbiAgcmV0dXJuIGAke2hvdXJ9OiR7YWRkWmVybyhtaW51dGUpfToke2FkZFplcm8odGltZSl9YFxyXG59XHJcblxyXG4vLyBGaWxtIHNwZWVkIGNoYW5nZVxyXG5cclxuc3BlZWRVcC5vbmNsaWNrID0gZSA9PiBzcGVlZENoYW5nZShlLnRhcmdldClcclxuc3BlZWREb3duLm9uY2xpY2sgPSBlID0+IHNwZWVkQ2hhbmdlKGUudGFyZ2V0KVxyXG5cclxuZnVuY3Rpb24gc3BlZWRDaGFuZ2UoYnRuKSB7XHJcbiAgaWYgKHNwZWVkVXAgPT09IGJ0biAmJiBmaWxtLnBsYXliYWNrUmF0ZSA8IDMpIHtcclxuICAgIGZpbG0ucGxheWJhY2tSYXRlICs9IDAuMjVcclxuICB9IGVsc2UgaWYgKHNwZWVkRG93biA9PT0gYnRuICYmIGZpbG0ucGxheWJhY2tSYXRlID4gMCkge1xyXG4gICAgZmlsbS5wbGF5YmFja1JhdGUgLT0gMC4yNVxyXG4gIH1cclxuICB3cml0ZVNwZWVkKClcclxufVxyXG5cclxuLy8gRmlsbSByZXN0YXJ0XHJcblxyXG5zdG9wLm9uY2xpY2sgPSBlID0+IHtcclxuICBpZiAoIWZpbG0ucGF1c2VkKSB7XHJcbiAgICBmaWxtLnBhdXNlKClcclxuICAgIGNsZWFySW50ZXJ2YWwoY3VycmVudFRpbWVJbnRlcnZhbClcclxuICAgIHBsYXlQYXVzZS5jbGFzc0xpc3QucmVtb3ZlKCdwYXVzZWQnKVxyXG4gIH1cclxuICBmaWxtLmN1cnJlbnRUaW1lID0gMFxyXG4gIGN1cnJlbnQuaW5uZXJIVE1MID0gdHJhbnNsYXRlVGltZShmaWxtLmN1cnJlbnRUaW1lKVxyXG4gIGZpbG0ucGxheWJhY2tSYXRlID0gMVxyXG4gIHdyaXRlU3BlZWQoKVxyXG59XHJcblxyXG4vLyBXcml0ZSBmaWxtIHNwZWVkXHJcbmZ1bmN0aW9uIHdyaXRlU3BlZWQoKSB7XHJcbiAgc3BlZWQuaW5uZXJIVE1MID0gZmlsbS5wbGF5YmFja1JhdGUgKyAneCdcclxufVxyXG5cclxuLy8gT24gZmlsbSBlbmRcclxuZmlsbS5vbmVuZGVkID0gKCkgPT4ge1xyXG4gIGZpbG0ucGF1c2UoKVxyXG4gIGNsZWFySW50ZXJ2YWwoY3VycmVudFRpbWVJbnRlcnZhbClcclxuICBwbGF5UGF1c2UuY2xhc3NMaXN0LnJlbW92ZSgncGF1c2VkJylcclxuICBmaWxtLmN1cnJlbnRUaW1lID0gMFxyXG4gIGN1cnJlbnQuaW5uZXJIVE1MID0gdHJhbnNsYXRlVGltZShmaWxtLmN1cnJlbnRUaW1lKVxyXG59XHJcblxyXG4vLyBWb2x1bWUgY2hhbmdlXHJcblxyXG5jb25zdCB2b2x1bWVDbGFzc2VzID0gWyd1cCcsICdzbGFzaCcsICdkb3duJywgJ25vcm1hbCcsICdvZmYnLCAnbXV0ZSddXHJcblxyXG5maWxtLm9udm9sdW1lY2hhbmdlID0gKCkgPT4ge1xyXG4gIHZvbHVtZVByb2dyZXNzLnN0eWxlLndpZHRoID0gZmlsbS52b2x1bWUgKiAxMDAgKyAnJSdcclxuXHJcbiAgbGV0IHZvbHVtZSA9IGZpbG0udm9sdW1lICogMTAwXHJcblxyXG5cclxuICB2b2x1bWVDbGFzc2VzLmZvckVhY2goY2xhc3NOYW1lID0+IHZvbHVtZUljb24uY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpKVxyXG4gIGlmIChmaWxtLm11dGVkKSB7XHJcbiAgICB2b2x1bWVJY29uLmNsYXNzTGlzdC5hZGQoJ3NsYXNoJylcclxuICB9IGVsc2UgaWYgKHZvbHVtZSA+IDc1KSB7XHJcbiAgICB2b2x1bWVJY29uLmNsYXNzTGlzdC5hZGQoJ3VwJylcclxuICB9IGVsc2UgaWYgKHZvbHVtZSA+IDUwKSB7XHJcbiAgICB2b2x1bWVJY29uLmNsYXNzTGlzdC5hZGQoJ25vcm1hbCcpXHJcbiAgfSBlbHNlIGlmICh2b2x1bWUgPiAyNSkge1xyXG4gICAgdm9sdW1lSWNvbi5jbGFzc0xpc3QuYWRkKCdkb3duJylcclxuICB9IGVsc2UgaWYgKHZvbHVtZSA+IDApIHtcclxuICAgIHZvbHVtZUljb24uY2xhc3NMaXN0LmFkZCgnb2ZmJylcclxuICB9IGVsc2UgaWYgKHZvbHVtZSA9PT0gMCkge1xyXG4gICAgdm9sdW1lSWNvbi5jbGFzc0xpc3QuYWRkKCdtdXRlJylcclxuICB9XHJcbn1cclxuXHJcbi8vIFZvbHVtZSBJY29uIGNsaWNrXHJcblxyXG52b2x1bWVJY29uLm9uY2xpY2sgPSAoKSA9PiBmaWxtLm11dGVkID0gIWZpbG0ubXV0ZWRcclxuXHJcbi8vIFZvbHVtZSBsaW5lIGNsaWNrIFxyXG5cclxudm9sdW1lTGluZS5vbmNsaWNrID0gZSA9PiB7XHJcbiAgaWYgKGUudGFyZ2V0ICE9PSB2b2x1bWVSdWxlcikge1xyXG4gICAgZmlsbS52b2x1bWUgPSBlLm9mZnNldFggLyAxMDBcclxuICB9XHJcbn1cclxuXHJcbi8vIFZvbHVtZSBSdWxlXHJcblxyXG52b2x1bWVSdWxlci5vbm1vdXNlZG93biA9ICgpID0+IHtcclxuICB3aW5kb3cub25tb3VzZW1vdmUgPSB2b2x1bWVNb3ZlXHJcbn1cclxud2luZG93Lm9ubW91c2V1cCA9ICgpID0+IHtcclxuICB3aW5kb3cub25tb3VzZW1vdmUgPSBudWxsXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZvbHVtZU1vdmUoZSkge1xyXG4gIGlmIChlLmNsaWVudFggPj0gdm9sdW1lTGluZS5vZmZzZXRMZWZ0ICYmIGUuY2xpZW50WCA8PSB2b2x1bWVMaW5lLm9mZnNldExlZnQgKyB2b2x1bWVMaW5lLmNsaWVudFdpZHRoKSB7XHJcbiAgICBmaWxtLnZvbHVtZSA9IChlLmNsaWVudFggLSB2b2x1bWVMaW5lLm9mZnNldExlZnQpIC8gMTAwXHJcbiAgfVxyXG59XHJcblxyXG4vLyBNb3VzZVdoZWVsIHZvbHVtZSBjb250cm9sXHJcblxyXG5maWxtQmxvY2sub253aGVlbCA9IGUgPT4ge1xyXG4gIGxldCB2b2x1bWUgPSBNYXRoLnRydW5jKGZpbG0udm9sdW1lICogMTAwKVxyXG4gIGlmIChlLmRlbHRhWSA8IDAgJiYgdm9sdW1lIDwgOTYpIHtcclxuICAgIHZvbHVtZSArPSA1XHJcbiAgfSBlbHNlIGlmIChlLmRlbHRhWSA+IDAgJiYgdm9sdW1lID4gNCkge1xyXG4gICAgdm9sdW1lIC09IDVcclxuICB9XHJcbiAgZmlsbS52b2x1bWUgPSB2b2x1bWUgLyAxMDBcclxufVxyXG5cclxuXHJcbi8vIENvbnRyb2xzIHBhbmVsIHNob3dcclxuXHJcbmNvbnN0IGNvbnRyb2xzU2hvdyA9ICgpPT57XHJcbiAgaWYgKHdpbmRvdy5pbm5lckhlaWdodCA8IHdpbmRvdy5pbm5lcldpZHRoKSB7XHJcbiAgICBpZiAoY29udHJvbHMuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykpIHtcclxuICAgICAgY29udHJvbHMuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5sZXQgY29udHJvbHNJbnRlcnZhbCA9IHNldEludGVydmFsKGNvbnRyb2xzU2hvdywgMzAwMClcclxuXHJcbmZpbG0ub250b3VjaHN0YXJ0ID0gKCk9PntcclxuICBjbGVhckludGVydmFsKGNvbnRyb2xzSW50ZXJ2YWwpXHJcbiAgY29udHJvbHNJbnRlcnZhbCA9IHNldEludGVydmFsKGNvbnRyb2xzU2hvdywgMzAwMClcclxuICBpZiAoIWNvbnRyb2xzLmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKSB7XHJcbiAgICBjb250cm9scy5jbGFzc0xpc3QuYWRkKCdzaG93JylcclxuICB9XHJcbn1cclxuXHJcblxyXG4vLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgKCk9PntcclxuLy8gICBpZiAob25lRmlsbS5vZmZzZXRUb3AgPCBwYWdlWU9mZnNldCArIGlubmVySGVpZ2h0KSB7XHJcbi8vICAgICBjb25zb2xlLmRpcihmaWxtKVxyXG4vLyAgICAgZmlsbS5wbGF5KClcclxuLy8gICB9XHJcbi8vIH0pIl0sImZpbGUiOiJjb21tb24ubWluLmpzIn0=
